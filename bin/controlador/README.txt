Aquí va la parte lógica del código